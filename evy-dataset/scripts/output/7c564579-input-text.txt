Find the number of subarrays with a given sum and maximum element